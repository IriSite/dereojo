<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Examen Ojo Derecho | Iri-Site</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container examen">
    <h2 class="instruccion">
      Por favor, c√∫brete el ojo izquierdo con la mano suavemente, sin apretar. 
      Col√≥cate a 2 metros de tu dispositivo y menciona en voz alta qu√© letra es
    </h2>

    <div class="letra-grande"></div> <!-- letra vac√≠a -->

    <div class="botones-respuesta">
      <button class="btn" onclick="responder(true)">‚úÖ</button>
      <button class="btn" onclick="responder(false)">‚ùå</button>
    </div>

    <div class="acciones">
      <button class="btn escuchar" id="toggleVoiceBtn" onclick="toggleVoice()">üîä Escuchar instrucciones</button>
      <button class="btn" id="siguienteBtn" onclick="irASiguiente()" disabled>Siguiente ‚û°Ô∏è</button>
    </div>
  </div>

  <script>
    const instrucciones = "Por favor, c√∫brete el ojo izquierdo con la mano suavemente, sin apretar. Col√≥cate a 2 metros de tu dispositivo y menciona en voz alta qu√© letra es";
    let estaHablando = false;
    let mensaje;

    function toggleVoice() {
      const boton = document.getElementById('toggleVoiceBtn');
      if (estaHablando) {
        speechSynthesis.cancel();
        boton.textContent = 'üîä Escuchar instrucciones';
        estaHablando = false;
      } else {
        mensaje = new SpeechSynthesisUtterance(instrucciones);
        mensaje.lang = 'es-MX';
        mensaje.rate = 1;
        mensaje.pitch = 1;
        mensaje.onend = () => {
          estaHablando = false;
          boton.textContent = 'üîä Escuchar instrucciones';
        };
        speechSynthesis.speak(mensaje);
        boton.textContent = 'üîá Detener voz';
        estaHablando = true;
      }
    }

    function responder(vioBien) {
      speechSynthesis.cancel();

      let aciertos = parseInt(localStorage.getItem('aciertos')) || 0;
      let errores = parseInt(localStorage.getItem('errores')) || 0;

      if (vioBien) {
        aciertos++;
      } else {
        errores++;
      }

      localStorage.setItem('aciertos', aciertos);
      localStorage.setItem('errores', errores);

      const retro = new SpeechSynthesisUtterance(
        vioBien ? "¬°Perfecto! Puedes ver con claridad con tu ojo derecho." :
                  "Gracias por indicarlo. No se distingui√≥ correctamente con tu ojo derecho."
      );
      retro.lang = 'es-MX';
      speechSynthesis.speak(retro);

      // Activar bot√≥n siguiente solo despu√©s de responder
      document.getElementById('siguienteBtn').disabled = false;
    }

    function irASiguiente() {
      window.location.href = 'pagina-siguiente.html'; // Cambia a tu siguiente p√°gina
    }

    // Funci√≥n para generar letra aleatoria A-Z
    function letraAleatoria() {
      const letras = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      return letras.charAt(Math.floor(Math.random() * letras.length));
    }

    window.onload = () => {
      // Asignar letra aleatoria al cargar la p√°gina
      document.querySelector('.letra-grande').textContent = letraAleatoria();

      toggleVoice();
    };
  </script>
</body>
</html>
